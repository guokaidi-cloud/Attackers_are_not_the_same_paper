(base) kaidiguo@kaidiguo-desktop-2004:~/workspace/Attackers-Are-Not-the-Same$ python main.py --attack cluster --use_emb  --dataset mnist  --num_pass 4 --lr_attack 0.1 --attack_i
d 1
/home/kaidiguo/anaconda3/lib/python3.9/site-packages/torch/cuda/__init__.py:63: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.
  import pynvml  # type: ignore[import]
/home/kaidiguo/anaconda3/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.8.1' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/home/kaidiguo/anaconda3/lib/python3.9/site-packages/pandas/core/arrays/masked.py:61: UserWarning: Pandas requires version '1.3.6' or newer of 'bottleneck' (version '1.3.4' currently installed).
  from pandas.core import (
Arguments:
                   as_order : False
                     attack : cluster
               attack_epoch : 1
        attack_every_n_iter : 100
                  attack_id : 1
        attack_model_epochs : 5
                   balanced : False
                 batch_size : 128
                    dataset : mnist
                    defense : False
                defense_all : False
                 dispersion : False
              division_mode : vertical
                     epochs : 10
                    epsilon : 0.01
                  lr_active : 0.01
                  lr_attack : 0.1
            lr_attack_model : 0.1
                 lr_passive : 0.01
                num_passive : 4
                        our : False
               padding_mode : False
                      round : 0
           set_attack_epoch : False
                     simple : False
                       tsne : False
                    use_emb : True
Passive Model Sequential(
  (0): Flatten_input()
  (1): Linear(in_features=196, out_features=196, bias=True)
  (2): BatchNorm1d(196, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (3): ReLU()
)
Passive Model Sequential(
  (0): Flatten_input()
  (1): Linear(in_features=196, out_features=196, bias=True)
  (2): BatchNorm1d(196, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (3): ReLU()
)
Passive Model Sequential(
  (0): Flatten_input()
  (1): Linear(in_features=196, out_features=196, bias=True)
  (2): BatchNorm1d(196, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (3): ReLU()
)
Passive Model Sequential(
  (0): Flatten_input()
  (1): Linear(in_features=196, out_features=196, bias=True)
  (2): BatchNorm1d(196, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (3): ReLU()
)
Active Model Sequential(
  (0): Dropout(p=0.5, inplace=False)
  (1): Linear(in_features=784, out_features=10, bias=True)
)
Finish processing dataset.
Attacker: cluster
Attack Runtime: 190:897:873 (ns)
Epoch:1/10, Step:100    Loss: 2.025288
Attack Runtime: 168:758:544 (ns)
Epoch:1/10, Step:200    Loss: 1.850574
Attack Runtime: 135:669:911 (ns)
Epoch:1/10, Step:300    Loss: 1.816785
Attack Runtime: 182:172:717 (ns)
Epoch:1/10, Step:400    Loss: 1.781661
Average Attack Accuracy of Passive 0 (each epoch): 15.89%
Average Attack Accuracy of Passive 1 (each epoch): 53.60%
Average Attack Accuracy of Passive 2 (each epoch): 45.13%
Average Attack Accuracy of Passive 3 (each epoch): 19.49%
Attack Runtime: 0:286:318 (ns)
Epoch:1/10, Step:469    Loss: 1.736186
Train set: Average loss: 1.7029, Accuracy: 50239/60000 (83.73%)

Attack Runtime: 160:686:676 (ns)
Epoch:2/10, Step:100    Loss: 1.724713
Attack Runtime: 167:963:372 (ns)
Epoch:2/10, Step:200    Loss: 1.646977
Attack Runtime: 189:895:405 (ns)
Epoch:2/10, Step:300    Loss: 1.686130
Attack Runtime: 190:194:352 (ns)
Epoch:2/10, Step:400    Loss: 1.627724
Average Attack Accuracy of Passive 0 (each epoch): 16.10%
Average Attack Accuracy of Passive 1 (each epoch): 69.28%
Average Attack Accuracy of Passive 2 (each epoch): 43.86%
Average Attack Accuracy of Passive 3 (each epoch): 20.55%
Attack Runtime: 0:188:976 (ns)
Epoch:2/10, Step:469    Loss: 1.633836
Train set: Average loss: 1.6216, Accuracy: 53219/60000 (88.70%)

Attack Runtime: 121:835:532 (ns)
Epoch:3/10, Step:100    Loss: 1.659752
Attack Runtime: 137:846:397 (ns)
Epoch:3/10, Step:200    Loss: 1.600617
Attack Runtime: 148:123:497 (ns)
Epoch:3/10, Step:300    Loss: 1.629212
Attack Runtime: 151:410:189 (ns)
Epoch:3/10, Step:400    Loss: 1.607352
Average Attack Accuracy of Passive 0 (each epoch): 16.10%
Average Attack Accuracy of Passive 1 (each epoch): 65.89%
Average Attack Accuracy of Passive 2 (each epoch): 44.92%
Average Attack Accuracy of Passive 3 (each epoch): 19.92%
Attack Runtime: 0:299:602 (ns)
Epoch:3/10, Step:469    Loss: 1.580064
Train set: Average loss: 1.5924, Accuracy: 54258/60000 (90.43%)

Attack Runtime: 145:150:977 (ns)
Epoch:4/10, Step:100    Loss: 1.612507
Attack Runtime: 142:718:156 (ns)
Epoch:4/10, Step:200    Loss: 1.582888
Attack Runtime: 140:292:783 (ns)
Epoch:4/10, Step:300    Loss: 1.631825
Attack Runtime: 136:657:280 (ns)
Epoch:4/10, Step:400    Loss: 1.600895
Average Attack Accuracy of Passive 0 (each epoch): 16.95%
Average Attack Accuracy of Passive 1 (each epoch): 69.28%
Average Attack Accuracy of Passive 2 (each epoch): 44.92%
Average Attack Accuracy of Passive 3 (each epoch): 20.97%
Attack Runtime: 0:317:197 (ns)
Epoch:4/10, Step:469    Loss: 1.566481
Train set: Average loss: 1.5763, Accuracy: 54807/60000 (91.34%)

Attack Runtime: 144:896:507 (ns)
Epoch:5/10, Step:100    Loss: 1.616390
Attack Runtime: 141:504:445 (ns)
Epoch:5/10, Step:200    Loss: 1.569184
Attack Runtime: 144:756:101 (ns)
Epoch:5/10, Step:300    Loss: 1.621783
Attack Runtime: 142:704:6 (ns)
Epoch:5/10, Step:400    Loss: 1.590741
Average Attack Accuracy of Passive 0 (each epoch): 16.95%
Average Attack Accuracy of Passive 1 (each epoch): 72.25%
Average Attack Accuracy of Passive 2 (each epoch): 47.03%
Average Attack Accuracy of Passive 3 (each epoch): 21.82%
Attack Runtime: 0:551:241 (ns)
Epoch:5/10, Step:469    Loss: 1.571229
Train set: Average loss: 1.5659, Accuracy: 55185/60000 (91.97%)

Attack Runtime: 142:748:26 (ns)
Epoch:6/10, Step:100    Loss: 1.598502
Attack Runtime: 140:582:44 (ns)
Epoch:6/10, Step:200    Loss: 1.566805
Attack Runtime: 143:85:181 (ns)
Epoch:6/10, Step:300    Loss: 1.599442
Attack Runtime: 141:471:979 (ns)
Epoch:6/10, Step:400    Loss: 1.566892
Average Attack Accuracy of Passive 0 (each epoch): 16.74%
Average Attack Accuracy of Passive 1 (each epoch): 66.10%
Average Attack Accuracy of Passive 2 (each epoch): 49.79%
Average Attack Accuracy of Passive 3 (each epoch): 20.76%
Attack Runtime: 0:308:976 (ns)
Epoch:6/10, Step:469    Loss: 1.549116
Train set: Average loss: 1.5584, Accuracy: 55463/60000 (92.44%)

Attack Runtime: 154:588:755 (ns)
Epoch:7/10, Step:100    Loss: 1.597800
Attack Runtime: 139:830:555 (ns)
Epoch:7/10, Step:200    Loss: 1.566827
Attack Runtime: 145:476:903 (ns)
Epoch:7/10, Step:300    Loss: 1.587041
Attack Runtime: 142:726:20 (ns)
Epoch:7/10, Step:400    Loss: 1.559445
Average Attack Accuracy of Passive 0 (each epoch): 16.74%
Average Attack Accuracy of Passive 1 (each epoch): 69.92%
Average Attack Accuracy of Passive 2 (each epoch): 53.39%
Average Attack Accuracy of Passive 3 (each epoch): 22.67%
Attack Runtime: 0:360:433 (ns)
Epoch:7/10, Step:469    Loss: 1.551955
Train set: Average loss: 1.5523, Accuracy: 55709/60000 (92.85%)

Attack Runtime: 143:168:830 (ns)
Epoch:8/10, Step:100    Loss: 1.565380
Attack Runtime: 147:468:683 (ns)
Epoch:8/10, Step:200    Loss: 1.555285
Attack Runtime: 144:955:737 (ns)
Epoch:8/10, Step:300    Loss: 1.570708
Attack Runtime: 143:624:882 (ns)
Epoch:8/10, Step:400    Loss: 1.547637
Average Attack Accuracy of Passive 0 (each epoch): 17.16%
Average Attack Accuracy of Passive 1 (each epoch): 68.01%
Average Attack Accuracy of Passive 2 (each epoch): 49.15%
Average Attack Accuracy of Passive 3 (each epoch): 22.46%
Attack Runtime: 0:324:962 (ns)
Epoch:8/10, Step:469    Loss: 1.534612
Train set: Average loss: 1.5474, Accuracy: 55917/60000 (93.19%)

Attack Runtime: 145:342:228 (ns)
Epoch:9/10, Step:100    Loss: 1.574404
Attack Runtime: 137:595:504 (ns)
Epoch:9/10, Step:200    Loss: 1.554645
Attack Runtime: 191:471:732 (ns)
Epoch:9/10, Step:300    Loss: 1.592038
Attack Runtime: 197:455:325 (ns)
Epoch:9/10, Step:400    Loss: 1.550457
Average Attack Accuracy of Passive 0 (each epoch): 16.74%
Average Attack Accuracy of Passive 1 (each epoch): 65.04%
Average Attack Accuracy of Passive 2 (each epoch): 48.09%
Average Attack Accuracy of Passive 3 (each epoch): 20.55%
Attack Runtime: 0:218:680 (ns)
Epoch:9/10, Step:469    Loss: 1.527193
Train set: Average loss: 1.5435, Accuracy: 56049/60000 (93.42%)

Attack Runtime: 171:42:568 (ns)
Epoch:10/10, Step:100   Loss: 1.582524
Attack Runtime: 91:689:165 (ns)
Epoch:10/10, Step:200   Loss: 1.548956
Attack Runtime: 96:801:283 (ns)
Epoch:10/10, Step:300   Loss: 1.577024
Attack Runtime: 107:339:753 (ns)
Epoch:10/10, Step:400   Loss: 1.548925
Average Attack Accuracy of Passive 0 (each epoch): 16.74%
Average Attack Accuracy of Passive 1 (each epoch): 66.95%
Average Attack Accuracy of Passive 2 (each epoch): 48.09%
Average Attack Accuracy of Passive 3 (each epoch): 20.55%
Attack Runtime: 0:235:783 (ns)
Epoch:10/10, Step:469   Loss: 1.530599
Train set: Average loss: 1.5400, Accuracy: 56198/60000 (93.66%)